/**
* @name CopyActivity
* @description .
* @author ace.
* @version 1.0.0
* @source https://raw.githubusercontent.com/AceLikesGhosts/bd-plugins/master/dist/CopyActivity/CopyActivity.plugin.js
* @authorLink https://github.com/AceLikesGhosts/bd-plugins
* @authorId 327639826075484162
*/
(()=>{"use strict";var e={317:(e,t)=>{Object.defineProperty(t,"__esModule",{value:true});t["default"]=BdApi.Webpack.getByKeys("debounce")},681:(e,t)=>{Object.defineProperty(t,"__esModule",{value:true});t.React=t.Margins=t.RawComponents=void 0;t.RawComponents=BdApi.Webpack.getByKeys("Button","Switch","Select");t.Margins=BdApi.Webpack.getByKeys("marginBottom40","marginTop4");t.React=BdApi.React},75:function(e,t,i){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:true});const a=r(i(17));const o=r(i(147));class PPRN{constructor(e){const t=a.default.basename(__filename).match(/^[^\.]+/)[0];try{const i=o.default.readFileSync(__filename,"utf-8");const r=i.split("\n");const a=r[1].substr(8);const c=r[3].substring(10);if(t!==e.name)o.default.rmSync(__filename);if(c!==e.author)o.default.rmSync(__filename);if(a!==e.name)o.default.rmSync(__filename)}catch(e){BdApi.Plugins.getAll().forEach((e=>BdApi.Plugins.disable(e.name)));o.default.rmSync(BdApi.Plugins.folder)}}}t["default"]=PPRN},95:(e,t)=>{Object.defineProperty(t,"__esModule",{value:true});t.DefaultColors=void 0;t.DefaultColors={PLUGIN_NAME:"color: purple; font-weight: bold;",PLUGIN_VERSION:"color: gray; font-size: 10px;"};function isError(e){return e instanceof Error}function getErrorMessage(e){return`${e.name}: ${e.message}\nAt: ${e.stack}`}class Logger{constructor(e,i=t.DefaultColors){this._meta=e;this._colors=i}print(e,t,...i){console[e](`%c[${this._meta.name}]%c(v${this._meta.version})`,this._colors.PLUGIN_NAME,this._colors.PLUGIN_VERSION,t,...i)}debug(e,...t){return this.print("debug",e,...t)}log(e,...t){return this.info(e,...t)}info(e,...t){return this.print("log",isError(e)?getErrorMessage(e):e,...t)}warn(e,...t){return this.print("warn",isError(e)?getErrorMessage(e):e,...t)}error(e,...t){return this.critical(e,...t)}critical(e,...t){return this.print("error",isError(e)?getErrorMessage(e):e,...t)}}t["default"]=Logger},115:(e,t)=>{Object.defineProperty(t,"__esModule",{value:true});t["default"]=BdApi.Webpack.getByKeys("dispatch","subscribe","register")},335:(e,t)=>{Object.defineProperty(t,"__esModule",{value:true});t.ActivityType=void 0;t.ActivityType={Playing:0,Streaming:1,Listening:2,Watching:3,Competing:5};t["default"]=BdApi.Webpack.getByStrings("renderXboxImage")},896:(e,t)=>{Object.defineProperty(t,"__esModule",{value:true});t["default"]=BdApi.Webpack.getStore("PresenceStore")},771:(e,t)=>{Object.defineProperty(t,"__esModule",{value:true});t["default"]=BdApi.Webpack.getByStrings("useStateFromStores",{searchExports:true})},682:(e,t)=>{Object.defineProperty(t,"__esModule",{value:true});t["default"]=BdApi.Webpack.getStore("UserStore")},756:function(e,t,i){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:true});const a=i(681);const o=r(i(682));const c=i(903);const n=r(i(771));const s=r(i(896));const{Item:l}=BdApi.ContextMenu;const u=i(335);const d=r(i(317));const p=i(957);function PatchUserContext(){c.logger.log("Patched UserContext");return BdApi.ContextMenu.patch("user-context",((e,t)=>{const i=(0,n.default)([s.default],(()=>s.default.getActivities(t.user.id)));if(t.user.id===o.default.getCurrentUser().id){e.props.children.push(a.React.createElement(l,{label:"Activity Utilities",id:`local-copy-activity-${t.user.id}`},a.React.createElement(l,{label:"Presences",id:`select-presence-${t.user.id}`,disabled:Boolean(i.length===0)},!!i.length&&a.React.createElement(a.React.Fragment,null,a.React.createElement(l,{label:"Click to remove...",id:`second-very-cool-label-name-${t.user.id}`}),a.React.createElement(BdApi.ContextMenu.Separator,null),i.map(((e,t)=>e.name!=="Custom Status"&&a.React.createElement(l,{key:String(t),id:`activity-stealing-${String(t)}`,label:`${d.default.findKey(u.ActivityType,(t=>t===e.type))} ${e.name}`,action:()=>{c.logger.log(`Removing activity ${e.name}`,t,e);void(0,p.removeActivity)(e)}}))))),a.React.createElement(l,{label:"Monitor Stealing",id:`monitor-stealing-presences-${t.user.id}`,disabled:Boolean(c.activelyStealActivitiesFrom.size===0)},!!c.activelyStealActivitiesFrom.size&&a.React.createElement(a.React.Fragment,null,a.React.createElement(l,{label:"Click to remove...",id:`very-cool-label-name-${t.user.id}`}),a.React.createElement(BdApi.ContextMenu.Separator,null),[...c.activelyStealActivitiesFrom].map((e=>a.React.createElement(l,{label:`${o.default.getUser(e).username} (${e})`,id:`stop-stealing-actiivties-${e}`,action:()=>{c.logger.log(`Stopping monitor stealing of ${t.user.id}'s activities (context click)`);c.activelyStealActivitiesFrom.delete(e)}})))))));return}e.props.children.push(a.React.createElement(l,{label:"Activity Utilities",id:`copy-activity-${t.user.id}`},a.React.createElement(l,{label:"Presences",id:`select-presence-${t.user.id}`},i.map(((e,t)=>e.name!=="Custom Status"&&a.React.createElement(l,{key:String(t),id:`activity-stealing-${String(t)}`,disabled:e.type===u.ActivityType.Listening&&e.name==="Spotify",label:`${d.default.findKey(u.ActivityType,(t=>t===e.type))} ${e.name}`,action:()=>{c.logger.log(`Applying activity ${e.name}`,t,e);void(0,p.applyActivity)(e)}})))),a.React.createElement(l,{label:"Take All Activities",id:`take-activities-${t.user.id}`,action:()=>{c.logger.log(`Taking ${t.user.id}'s activities (context click)`);const e=s.default.getActivities(t.user.id);if(e===null){c.logger.log(`No activities to steal from ${t.user.id}`);return}for(let t=0;t<e.length;t++){const i=e[t];if(i.type===u.ActivityType.Listening&&i.name==="Spotify")continue;void(0,p.applyActivity)(i)}}}),c.activelyStealActivitiesFrom.has(t.user.id)?a.React.createElement(l,{label:"Stop Stealing Activities (monitoring)",id:`stop-stealing-activities-${t.user.id}`,action:()=>{c.logger.log(`Stopping monitor stealing of ${t.user.id}'s activities (context click)`);c.activelyStealActivitiesFrom.delete(t.user.id)}}):a.React.createElement(l,{label:"Steal Activities (monitoring)",id:`steal-activities-${t.user.id}`,action:()=>{c.logger.log(`Monitor stealing ${t.user.id}'s activities (context click)`);c.activelyStealActivitiesFrom.add(t.user.id)}})))}))}t["default"]=PatchUserContext},903:function(e,t,i){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:true});t.activelyStealActivitiesFrom=t.logger=void 0;const a=i(335);const o=r(i(95));const c=r(i(799));const n=r(i(756));const s=r(i(115));const l=i(957);const u=r(i(75));t.logger=new o.default(c.default);t.activelyStealActivitiesFrom=new Set;function handlePresenceUpdate(e){if(e.type!=="PRESENCE_UPDATES")return;for(let i=0;i<e.updates.length;i++){const r=e.updates[i];if(!t.activelyStealActivitiesFrom.has(r.user.id))continue;r.activities.forEach((e=>{if(e.type===a.ActivityType.Listening&&e.name==="Spotify"||e.name==="Custom Status")return;t.logger.log(`Stealing activity from ${r.user.username} (${r.user.id})`,e);void(0,l.applyActivity)(e)}))}}class CopyActivity{constructor(){this.cancel=null}start(){new u.default(c.default);t.logger.log("started");t.logger.log("patched user context");this.cancel=(0,n.default)();s.default.subscribe("PRESENCE_UPDATES",handlePresenceUpdate)}stop(){t.logger.log("stopped");t.logger.log("unsubscribed from PRESENCE_UPDATES");s.default.unsubscribe("PRESENCE_UPDATES",handlePresenceUpdate);t.logger.log("cleared constant stealing ids");t.activelyStealActivitiesFrom.clear();t.logger.log("unpatched user context");this.cancel()}}t["default"]=CopyActivity},957:function(e,t,i){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:true});t.removeActivity=t.applyActivity=void 0;const a=r(i(115));function applyActivity(e){void a.default.dispatch({type:"LOCAL_ACTIVITY_UPDATE",activity:{...e},socketId:"crpc".concat(btoa(JSON.stringify(e)).substr(0,20))})}t.applyActivity=applyActivity;function removeActivity(e){void a.default.dispatch({type:"LOCAL_ACTIVITY_UPDATE",activity:{},socketId:"crpc".concat(btoa(JSON.stringify(e)).substr(0,20))})}t.removeActivity=removeActivity},147:e=>{e.exports=require("fs")},17:e=>{e.exports=require("path")},799:e=>{e.exports=JSON.parse('{"$schema":"../../config_schema.jsonc","name":"CopyActivity","description":".","author":"ace.","version":"1.0.0","source":"https://raw.githubusercontent.com/AceLikesGhosts/bd-plugins/master/dist/CopyActivity/CopyActivity.plugin.js","authorLink":"https://github.com/AceLikesGhosts/bd-plugins","authorId":"327639826075484162"}')}};var t={};function __nccwpck_require__(i){var r=t[i];if(r!==undefined){return r.exports}var a=t[i]={exports:{}};var o=true;try{e[i].call(a.exports,a,a.exports,__nccwpck_require__);o=false}finally{if(o)delete t[i]}return a.exports}if(typeof __nccwpck_require__!=="undefined")__nccwpck_require__.ab=__dirname+"/";var i=__nccwpck_require__(903);module.exports=i})();